openapi: 3.0.3
info:
  version: 1.0.0
  title: SignalWire Logs API
  description: API to manage and query log data for SignalWire.
  termsOfService: https://signalwire.com/legal/signalwire-cloud-agreement
servers:
  - url: https://{space_name}.signalwire.com/api/logs
    variables:
      space_name:
        default: YOUR_SPACE
        description: Your SignalWire Space's subdomain.
tags:
  - name: Conferences

paths:
  /conferences:
    get:
      operationId: list_conferences
      tags:
        - Conferences
      summary: List Conferences
      description: Get a list of conference logs.
      responses:
        '200':
          description: A list of conference logs.
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      oneOf:
                        - $ref: '#/components/schemas/VideoRoomSessionConference'
                        - $ref: '#/components/schemas/LamlConference'
                        - $ref: '#/components/schemas/RelayConference'
                      discriminator:
                        propertyName: type
components:
  schemas:
    Conference:
      type: object
      required:
        - id
        - created_at
      properties:
        id:
          type: string
        created_at:
          type: string
          format: date-time

    VideoRoomSessionConference:
      allOf:
        - $ref: '#/components/schemas/Conference'
        - type: object
          required:
            - type
            - room_name
            - url
            - status
            - locked
            - started_at
            - ended_at
            - charge
            - charge_details
          properties:
            type:
              type: string
              enum: [video_conference_session]
            source:
              type: string
              example: realtime_api
            url:
              type: string
              example: https://test.signalwire.com/api/video/room_sessions/UUID
            room_name:
              type: string
            status:
              type: string
            locked:
              type: boolean
            started_at:
              type: string
              format: date-time
            ended_at:
              type: string
              format: date-time
            charge:
              type: string
            charge_details:
              type: array
              items:
                $ref: '#/components/schemas/ChargeDetails'

    LamlConference:
      allOf:
        - $ref: '#/components/schemas/Conference'
        - type: object
          properties:
            type:
              type: string
              enum: [laml_conference]

    RelayConference:
      allOf:
        - $ref: '#/components/schemas/Conference'
        - type: object
          required:
            - type
            - recording_url
            - recording_duration
            - recording_file_size
          properties:
            type:
              type: string
              enum: [relay_conference]
            recording_url:
              type: string
              example: http://record.com
            recording_duration:
              type: integer
              example: 123
            recording_file_size:
              type: integer
              example: 12345

    ChargeDetails:
      type: object
      required:
        - description
        - amount
      properties:
        description:
          type: string
        amount:
          type: integer
