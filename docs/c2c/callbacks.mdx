---
title: "Event Callbacks"
description: "Learn how to use event callbacks to control the behavior of your Click-to-Call implementation"
sidebar_position: 3
slug: /c2c/callbacks
---

# Event Callbacks

Click-to-Call provides a set of callback functions that allow you to hook into different stages of the call lifecycle. These callbacks give you fine-grained control over call behavior and enable you to integrate the C2C widget seamlessly with your application's UI and logic.

## Available Callbacks

### beforeCallStartFn

This callback is invoked before a call is initiated. It gives you the opportunity to decide whether the call should proceed or be canceled.

**Return Value:**
- `true`: Proceed with the call
- `false`: Cancel the call

**Example:**

```javascript
beforeCallStartFn: () => {
  // Check if it's during business hours
  const now = new Date();
  const hour = now.getHours();
  
  if (hour < 9 || hour >= 17) {
    alert('Sorry, our call center is only available from 9 AM to 5 PM.');
    return false; // Don't proceed with the call
  }
  
  // Show a loading spinner
  document.getElementById('loading-spinner').style.display = 'block';
  
  return true; // Proceed with the call
}
```

### afterCallStartFn

This callback is invoked after a call has been successfully connected. It's useful for updating your UI to reflect the active call state.

**Example:**

```javascript
afterCallStartFn: () => {
  // Hide the loading spinner
  document.getElementById('loading-spinner').style.display = 'none';
  
  // Hide the call button while in a call
  document.getElementById('click2call').style.display = 'none';
  
  // Update page status
  document.getElementById('call-status').innerText = 'In call';
  
  // You could also disable other interactive elements on your page
  document.querySelectorAll('.interactive-element').forEach(el => {
    el.setAttribute('disabled', 'true');
  });
}
```

### beforeCallLeaveFn

This callback is invoked before a call is hung up. It allows you to add confirmation dialogs or perform cleanup tasks before ending the call.

**Return Value:**
- `true`: Proceed with hanging up
- `false`: Cancel the hangup request

**Example:**

```javascript
beforeCallLeaveFn: () => {
  // Ask for confirmation
  const shouldHangup = confirm('Are you sure you want to end this call?');
  
  if (shouldHangup) {
    // Prepare for call end
    document.getElementById('call-ending').style.display = 'block';
  }
  
  return shouldHangup;
}
```

### afterCallLeaveFn

This callback is invoked after a call has ended and the call widget is no longer visible. It's the perfect place to reset your UI to its pre-call state.

**Example:**

```javascript
afterCallLeaveFn: () => {
  // Hide call-ending indicator
  document.getElementById('call-ending').style.display = 'none';
  
  // Show the call button again
  document.getElementById('click2call').style.display = 'block';
  
  // Update page status
  document.getElementById('call-status').innerText = 'Call ended';
  
  // Re-enable interactive elements
  document.querySelectorAll('.interactive-element').forEach(el => {
    el.removeAttribute('disabled');
  });
  
  // Maybe show a feedback form
  setTimeout(() => {
    document.getElementById('call-feedback-form').style.display = 'block';
  }, 1000);
}
```

### onCallError

This callback is invoked if any error occurs during call setup. It receives the error object as a parameter, allowing you to handle different error scenarios appropriately.

**Parameters:**
- `error`: The error object containing details about what went wrong

**Example:**

```javascript
onCallError: (error) => {
  console.error('Call setup failed:', error);
  
  // Hide loading spinner if it's showing
  document.getElementById('loading-spinner').style.display = 'none';
  
  // Show appropriate error message based on error type
  if (error.name === 'MediaDeviceError') {
    alert('Cannot access microphone. Please ensure you have granted microphone permissions to this site.');
  } else if (error.name === 'NetworkError') {
    alert('Network connection issue. Please check your internet connection and try again.');
  } else {
    alert('Sorry, we couldn\'t connect your call. Please try again later.');
  }
  
  // Log the error to your analytics or monitoring system
  logErrorToAnalytics(error);
}
```

## Callback Flow

The following diagram illustrates the order in which callbacks are invoked during a typical call lifecycle:

1. User clicks the C2C button
2. ➡️ `beforeCallStartFn()` is called
3. If returned `true`, call setup begins
4. Call connects
5. ➡️ `afterCallStartFn()` is called
6. User or system initiates call end
7. ➡️ `beforeCallLeaveFn()` is called
8. If returned `true`, call teardown begins
9. Call ends
10. ➡️ `afterCallLeaveFn()` is called

If an error occurs at any point during setup:
- ➡️ `onCallError(error)` is called

## Best Practices

- **Keep callbacks lightweight**: Avoid performing time-consuming operations in callbacks, especially in `beforeCallStartFn` and `beforeCallLeaveFn`, as this can delay call setup or teardown.
- **Handle errors gracefully**: Always implement the `onCallError` callback to provide meaningful feedback to users when something goes wrong.
- **UI consistency**: Use `afterCallStartFn` and `afterCallLeaveFn` to maintain consistent UI states that clearly indicate to the user whether they are in a call.
- **Provide visual feedback**: Implement loading indicators and status messages to keep users informed about what's happening.
- **Test edge cases**: Make sure to test your callbacks with various scenarios, including cases where a call might not connect or disconnects unexpectedly. 